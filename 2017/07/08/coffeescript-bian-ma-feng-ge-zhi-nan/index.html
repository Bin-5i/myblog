<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>CoffeeScript 编码风格指南 | Bin 博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">CoffeeScript 编码风格指南</h1><a id="logo" href="/.">Bin 博客</a><p class="description">一名资深IT开发者.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">CoffeeScript 编码风格指南</h1><div class="post-meta">Jul 8, 2017<span> | </span><span class="category"><a href="/categories/技术分享/">技术分享</a></span></div><div class="post-content"><p>‘copy from: <a href="https://github.com/geekplux/coffeescript-style-guide/blob/master/README.md" target="_blank" rel="noopener">https://github.com/geekplux/coffeescript-style-guide/blob/master/README.md</a><br>这份指南阐述了一些 <a href="http://jashkenas.github.com/coffee-script/" target="_blank" rel="noopener">CoffeeScript</a> 的最佳实践和编码惯例。</p>
<p>这份指南是社群驱动的，非常鼓励大家来贡献内容。</p>
<p>请注意这还是一份正在完善的指南：仍有很多地方可以改进，有些已制定的准则也不一定是社区惯用的（基于此，在适当的情况下，这些有待斟酌的准则将有可能被修改或删除。）</p>
<h2 id="灵感"><a href="#灵感" class="headerlink" title="灵感"></a>灵感</h2><p>本指南中的很多细节受到了几份现有的风格指南和其他资源的启发。特别是：</p>
<ul>
<li><a href="http://www.python.org/dev/peps/pep-0008/" target="_blank" rel="noopener">PEP-8</a>: Style Guide for Python Code</li>
<li>Bozhidar Batsov’s <a href="https://github.com/bbatsov/ruby-style-guide" target="_blank" rel="noopener">Ruby Style Guide</a></li>
<li><a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml" target="_blank" rel="noopener">Google’s JavaScript Style Guide</a></li>
<li><a href="http://arcturo.github.com/library/coffeescript/04_idioms.html" target="_blank" rel="noopener">Common CoffeeScript Idioms</a></li>
<li>Thomas Reynolds’ <a href="http://awardwinningfjords.com/2011/05/13/coffeescript-specific-style-guide.html" target="_blank" rel="noopener">CoffeeScript-specific Style Guide</a></li>
<li>Jeremy Ashkenas’ <a href="https://gist.github.com/1005723" target="_blank" rel="noopener">code review</a> of <a href="http://spinejs.com/" target="_blank" rel="noopener">Spine</a></li>
<li>The <a href="https://github.com/jashkenas/coffee-script/wiki/FAQ" target="_blank" rel="noopener">CoffeeScript FAQ</a></li>
</ul>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#guide">CoffeeScript 风格指南</a><ul>
<li><a href="#code_layout">代码布局（Code Layout）</a><ul>
<li><a href="#tabs_or_spaces">Tab 还是 空格？（Tabs or Spaces?）</a></li>
<li><a href="#maximum_line_length">最大行宽（Maximum Line Length）</a></li>
<li><a href="#blank_lines">空行（Blank Lines）</a></li>
<li><a href="#trailing_whitespace">结尾空白（Trailing Whitespace）</a></li>
<li><a href="#optional_commas">可选的逗号（Optional Commas）</a></li>
<li><a href="#encoding">编码（Encoding）</a></li>
</ul>
</li>
<li><a href="#module_imports">模块导入（Module Imports）</a></li>
<li><a href="#whitespace">表达式和语句中的空白（Whitespace in Expressions and Statements）</a></li>
<li><a href="#comments">注释（Comments）</a><ul>
<li><a href="#block_comments">块注释（Block Comments）</a></li>
<li><a href="#inline_comments">行内注释（Inline Comments）</a></li>
</ul>
</li>
<li><a href="#naming_conventions">命名规范（Naming Conventions）</a></li>
<li><a href="#functions">函数（Functions）</a></li>
<li><a href="#strings">字符串（Strings）</a></li>
<li><a href="#conditionals">条件判断（Conditionals）</a></li>
<li><a href="#looping_and_comprehensions">循环和列表解析（Looping and Comprehensions）</a></li>
<li><a href="#extending_native_objects">扩展本地对象（Extending Native Objects）</a></li>
<li><a href="#exceptions">异常（Exceptions）</a></li>
<li><a href="#annotations">注解（Annotations）</a></li>
<li><a href="#miscellaneous">其他（Miscellaneous）</a></li>
</ul>
</li>
</ul>
<p><a name="code_layout"></a></p>
<h2 id="代码布局（Code-Layout）"><a href="#代码布局（Code-Layout）" class="headerlink" title="代码布局（Code Layout）"></a>代码布局（Code Layout）</h2><p><a name="tabs_or_spaces"></a></p>
<h3 id="Tab-还是-空格？（Tabs-or-Spaces-）"><a href="#Tab-还是-空格？（Tabs-or-Spaces-）" class="headerlink" title="Tab 还是 空格？（Tabs or Spaces?）"></a>Tab 还是 空格？（Tabs or Spaces?）</h3><p>只用 <strong>空格</strong>，每级缩进均为 <strong>2 个空格</strong>。切勿混用 Tab 和空格。</p>
<p><a name="maximum_line_length"></a></p>
<h3 id="最大行宽（Maximum-Line-Length）"><a href="#最大行宽（Maximum-Line-Length）" class="headerlink" title="最大行宽（Maximum Line Length）"></a>最大行宽（Maximum Line Length）</h3><p>限制每行最多 79 个字符。</p>
<p><a name="blank_lines"></a></p>
<h3 id="空行（Blank-Lines）"><a href="#空行（Blank-Lines）" class="headerlink" title="空行（Blank Lines）"></a>空行（Blank Lines）</h3><p>顶级函数和类的定义用一个空行分开。</p>
<p>类内部的函数定义也用一个空行分开。</p>
<p>对于每个函数体内，只在为了提高可读性的情况下才使用一个空行（例如：为了达到划分逻辑的目的）。</p>
<p><a name="trailing_whitespace"></a></p>
<h3 id="结尾空白（Trailing-Whitespace）"><a href="#结尾空白（Trailing-Whitespace）" class="headerlink" title="结尾空白（Trailing Whitespace）"></a>结尾空白（Trailing Whitespace）</h3><p>不要在任何一行保留行尾空白。</p>
<p><a name="optional_commas"></a></p>
<h3 id="可选的逗号（Optional-Commas）"><a href="#可选的逗号（Optional-Commas）" class="headerlink" title="可选的逗号（Optional Commas）"></a>可选的逗号（Optional Commas）</h3><p>当对象（或数组）的属性（或元素）作为单独一行列出时，避免在换行符前使用逗号。如下：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 好</span></span><br><span class="line">foo = [</span><br><span class="line">  <span class="string">'some'</span></span><br><span class="line">  <span class="string">'string'</span></span><br><span class="line">  <span class="string">'values'</span></span><br><span class="line">]</span><br><span class="line">bar:</span><br><span class="line">  label: <span class="string">'test'</span></span><br><span class="line">  value: <span class="number">87</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 差</span></span><br><span class="line">foo = [</span><br><span class="line">  <span class="string">'some'</span>,</span><br><span class="line">  <span class="string">'string'</span>,</span><br><span class="line">  <span class="string">'values'</span></span><br><span class="line">]</span><br><span class="line">bar:</span><br><span class="line">  label: <span class="string">'test'</span>,</span><br><span class="line">  value: <span class="number">87</span></span><br></pre></td></tr></table></figure>
<p><a name="encoding"></a></p>
<h3 id="编码（Encoding）"><a href="#编码（Encoding）" class="headerlink" title="编码（Encoding）"></a>编码（Encoding）</h3><p>UTF-8 是首选的源文件编码。</p>
<p><a name="module_imports"></a></p>
<h2 id="模块导入（Module-Imports）"><a href="#模块导入（Module-Imports）" class="headerlink" title="模块导入（Module Imports）"></a>模块导入（Module Imports）</h2><p>如果需要导入模块 (CommonJS 模块，AMD，等等.), <code>require</code> 语句应该单独作为一行。如下：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">'lib/setup'</span></span><br><span class="line">Backbone = <span class="built_in">require</span> <span class="string">'backbone'</span></span><br></pre></td></tr></table></figure>
<p>这些语句应该按以下顺序去分组：</p>
<ol>
<li>标准库的导入 <em>（如果标准库存在）</em></li>
<li>第三方库的导入</li>
<li>本地导入 <em>（导入这个应用程序的或库的具体依赖）</em></li>
</ol>
<p><a name="whitespace"></a></p>
<h2 id="表达式和语句中的空白（Whitespace-in-Expressions-and-Statements）"><a href="#表达式和语句中的空白（Whitespace-in-Expressions-and-Statements）" class="headerlink" title="表达式和语句中的空白（Whitespace in Expressions and Statements）"></a>表达式和语句中的空白（Whitespace in Expressions and Statements）</h2><p>下列情况应该避免多余的空格：</p>
<ul>
<li><p>紧贴着圆括号、方括号和大括号内部</p>
  <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">($ <span class="string">'body'</span>) <span class="comment"># 好</span></span><br><span class="line">( $ <span class="string">'body'</span> ) <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>紧贴在逗号前</p>
  <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log x, y <span class="comment"># 好</span></span><br><span class="line"><span class="built_in">console</span>.log x , y <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>额外建议：</p>
<ul>
<li><p>在下列二元操作符的左右两边都保留 <strong>一个空格</strong></p>
<ul>
<li><p>赋值运算符: <code>=</code></p>
<ul>
<li><p><em>注意这同样适用于函数定义中的默认参数</em></p>
 <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test: <span class="function"><span class="params">(param = <span class="literal">null</span>)</span> -&gt;</span> <span class="comment"># 好</span></span><br><span class="line">test: <span class="function"><span class="params">(param=<span class="literal">null</span>)</span> -&gt;</span> <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>自增运算符: <code>+=</code>, <code>-=</code>, 等等。</p>
</li>
<li>比较运算符: <code>==</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>unless</code>, 等等。</li>
<li><p>算术运算符: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, 等等。</p>
</li>
<li><p><em>（这些操作符两边的空格不要多于一个）</em></p>
  <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 好</span></span><br><span class="line">x = <span class="number">1</span></span><br><span class="line">y = <span class="number">1</span></span><br><span class="line">fooBar = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 差</span></span><br><span class="line">x      = <span class="number">1</span></span><br><span class="line">y      = <span class="number">1</span></span><br><span class="line">fooBar = <span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><a name="comments"></a></p>
<h2 id="注释（Comments）"><a href="#注释（Comments）" class="headerlink" title="注释（Comments）"></a>注释（Comments）</h2><p>如果你修改了一段已有注释说明的代码，则也要更新它对应的注释。（理想状态是，重构这段代码直到它不需要注释说明，然后再把之前的注释全删掉。）</p>
<p>注释的首字母要大写，除非第一个单词是以小写字母开头的标识符。</p>
<p>如果注释很短，可以省略末尾的句号。</p>
<p><a name="block_comments"></a></p>
<h3 id="块注释（Block-Comments）"><a href="#块注释（Block-Comments）" class="headerlink" title="块注释（Block Comments）"></a>块注释（Block Comments）</h3><p>注释块通常应用于尾随其后的一段代码。</p>
<p>每一行注释都以 <code>#</code> 加一个空格开头，而且和被注释的代码有相同的缩进层次。</p>
<p>注释块内的段落以仅含单个 <code>#</code> 的行分割。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这是一个块注释。请注意假如这是一段块注释，</span></span><br><span class="line"><span class="comment"># 则它描述的就应该是接下来的这段代码。</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 这是块注释的第二段。</span></span><br><span class="line"><span class="comment"># 请注意这段是由上一行带有 # 号的空行分开的。（P.S. 最好用英文写注释）</span></span><br><span class="line"></span><br><span class="line">init()</span><br><span class="line">start()</span><br><span class="line">stop()</span><br></pre></td></tr></table></figure>
<p><a name="inline_comments"></a></p>
<h3 id="行内注释（Inline-Comments）"><a href="#行内注释（Inline-Comments）" class="headerlink" title="行内注释（Inline Comments）"></a>行内注释（Inline Comments）</h3><p>行内注释紧贴在被描述的代码的上一行，如果行内注释足够短，则可以处在同一行行尾（由一个空格隔开）。</p>
<p>所有行内注释都以 <code>#</code> 加一个空格开头。</p>
<p>应该限制行内注释的使用，因为它们的存在通常是一个代码异味的标志。</p>
<p>不要给显而易见的情况作行内注释：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 差</span></span><br><span class="line">x = x + <span class="number">1</span> <span class="comment"># x 自增</span></span><br></pre></td></tr></table></figure>
<p>然而，行内注释在某些情况下是有用的：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 好</span></span><br><span class="line">x = x + <span class="number">1</span> <span class="comment"># 边界补足</span></span><br></pre></td></tr></table></figure>
<p><a name="naming_conventions"></a></p>
<h2 id="命名规范（Naming-Conventions）"><a href="#命名规范（Naming-Conventions）" class="headerlink" title="命名规范（Naming Conventions）"></a>命名规范（Naming Conventions）</h2><p>使用 <code>小驼峰命名法</code> （第一个词的首字母小写，后面每个词的首字母大写）来命名所有的变量、方法和对象属性。</p>
<p>使用 <code>大驼峰命名法</code> （第一个词的首字母，以及后面每个词的首字母都大写）来命名所有的类 <em>（在<a href="http://en.wikipedia.org/wiki/CamelCase#Variations_and_synonyms" target="_blank" rel="noopener">其他类似的命名法</a>中，这种风格通常也被称为 <code>帕斯卡命名法（PascalCase）</code>、 <code>大写驼峰命名法（CamelCaps）</code> 或 <code>首字母大写命名法（CapWords）</code>。）</em></p>
<p><em>（CoffeeScript <strong>官方</strong>  约定是用驼峰命名法，因为这可以简化与 JavaScript 的相互转化，想了解更多，请看<a href="https://github.com/jashkenas/coffee-script/issues/425" target="_blank" rel="noopener">这里</a>.)</em></p>
<p>对于常量，单词全部大写，用下划线隔开即可：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_LIKE_THIS</span><br></pre></td></tr></table></figure>
<p>私有函数和私有变量都应该在前面加一个下划线：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_privateMethod: <span class="function">-&gt;</span></span><br></pre></td></tr></table></figure>
<p><a name="functions"></a></p>
<h2 id="函数（Functions）"><a href="#函数（Functions）" class="headerlink" title="函数（Functions）"></a>函数（Functions）</h2><p><em>（以下这些准则同样适用于类中的方法。）</em></p>
<p>当声明一个带参函数时，应在参数列表的右圆括号后空出一个空格：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">foo</span> = <span class="params">(arg1, arg2)</span> -&gt;</span> <span class="comment"># 好</span></span><br><span class="line"><span class="function"><span class="title">foo</span> = <span class="params">(arg1, arg2)</span>-&gt;</span> <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
<p>无参函数不要用圆括号：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">bar</span> = -&gt;</span> <span class="comment"># 好</span></span><br><span class="line"><span class="function"><span class="title">bar</span> = <span class="params">()</span> -&gt;</span> <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
<p>当函数链式调用，却在一行放不下时，则把每个函数调用都另起一行，且都缩进一级（即在 <code>.</code> 前加两个空格）。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1.</span><span class="number">.3</span>]</span><br><span class="line">  .map(<span class="function"><span class="params">(x)</span> -&gt;</span> x * x)</span><br><span class="line">  .concat([<span class="number">10.</span><span class="number">.12</span>])</span><br><span class="line">  .filter(<span class="function"><span class="params">(x)</span> -&gt;</span> x &lt; <span class="number">11</span>)</span><br><span class="line">  .reduce(<span class="function"><span class="params">(x, y)</span> -&gt;</span> x + y)</span><br></pre></td></tr></table></figure>
<p>当调用函数时，我们应该为了提高可读性而去掉圆括号。请记住，「可读性」是我们主观臆断的。只有类似下面几个例子的情况才被社区认为是最佳的：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">baz <span class="number">12</span></span><br><span class="line"></span><br><span class="line">brush.ellipse x: <span class="number">10</span>, y: <span class="number">20</span> <span class="comment"># 大括号在适当的时候也可以去掉</span></span><br><span class="line"></span><br><span class="line">foo(<span class="number">4</span>).bar(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">obj.value(<span class="number">10</span>, <span class="number">20</span>) / obj.value(<span class="number">20</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> inspect value</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Tag(<span class="keyword">new</span> Value(a, b), <span class="keyword">new</span> Arg(c))</span><br></pre></td></tr></table></figure>
<p>有时候你会发现圆括号用来包裹的是函数体（而不是函数的参数）。请看下面的例子（以下简称为「函数体风格」）：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">($ <span class="string">'#selektor'</span>).addClass <span class="string">'klass'</span></span><br><span class="line"></span><br><span class="line">(foo <span class="number">4</span>).bar <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>这段代码会编译为：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'#selektor'</span>).addClass <span class="string">'klass'</span></span><br><span class="line"></span><br><span class="line">foo(<span class="number">4</span>).bar <span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>一些习惯链式调用的人会巧用「函数体风格」进行单独初始化：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">($ <span class="string">'#selektor'</span>).addClass(<span class="string">'klass'</span>).hide() <span class="comment"># 单独初始化调用</span></span><br><span class="line">(($ <span class="string">'#selektor'</span>).addClass <span class="string">'klass'</span>).hide() <span class="comment"># 全部调用</span></span><br></pre></td></tr></table></figure>
<p>「函数体风格」并不得到推荐。但是， <strong>当它适应一些特殊的项目需求时，还是得用它。</strong></p>
<p><a name="strings"></a></p>
<h2 id="字符串（Strings）"><a href="#字符串（Strings）" class="headerlink" title="字符串（Strings）"></a>字符串（Strings）</h2><p>用字符串插值代替字符串连接符：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'this is an #&#123;adjective&#125; string'</span> <span class="comment"># 好</span></span><br><span class="line"><span class="string">'this is an '</span> + adjective + <span class="string">' string'</span> <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
<p>最好用单引号 (<code>&#39;&#39;</code>) 而不是双引号 (<code>&quot;&quot;</code>) 。除非是插入到另一段现有的字符串中（类似字符串插值）。</p>
<p><a name="conditionals"></a></p>
<h2 id="条件判断（Conditionals）"><a href="#条件判断（Conditionals）" class="headerlink" title="条件判断（Conditionals）"></a>条件判断（Conditionals）</h2><p>用 <code>unless</code> 来代替 <code>if</code> 的否定情况。</p>
<p>不要用 <code>unless...else</code>， 而用 <code>if...else</code>:</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 好</span></span><br><span class="line"><span class="keyword">if</span> <span class="literal">true</span></span><br><span class="line">  ...</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 差</span></span><br><span class="line"><span class="keyword">unless</span> <span class="literal">false</span></span><br><span class="line">  ...</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>多行的 if/else 语句应该缩进：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 好</span></span><br><span class="line"><span class="keyword">if</span> <span class="literal">true</span></span><br><span class="line">  ...</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 差</span></span><br><span class="line"><span class="keyword">if</span> <span class="literal">true</span> <span class="keyword">then</span> ...</span><br><span class="line"><span class="keyword">else</span> ...</span><br></pre></td></tr></table></figure>
<p><a name="looping_and_comprehensions"></a></p>
<h2 id="循环和列表解析（Looping-and-Comprehensions）"><a href="#循环和列表解析（Looping-and-Comprehensions）" class="headerlink" title="循环和列表解析（Looping and Comprehensions）"></a>循环和列表解析（Looping and Comprehensions）</h2><p>尽可能的使用列表解析：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 好</span></span><br><span class="line">result = (item.name <span class="keyword">for</span> item <span class="keyword">in</span> array)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 差</span></span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> array</span><br><span class="line">  results.push item.name</span><br></pre></td></tr></table></figure>
<p>还可以过滤结果：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = (item <span class="keyword">for</span> item <span class="keyword">in</span> array <span class="keyword">when</span> item.name <span class="keyword">is</span> <span class="string">"test"</span>)</span><br></pre></td></tr></table></figure>
<p>遍历对象的键值：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">object = one: <span class="number">1</span>, two: <span class="number">2</span></span><br><span class="line">alert(<span class="string">"<span class="subst">#&#123;key&#125;</span> = <span class="subst">#&#123;value&#125;</span>"</span>) <span class="keyword">for</span> key, value <span class="keyword">of</span> object</span><br></pre></td></tr></table></figure>
<p><a name="extending_native_objects"></a></p>
<h2 id="扩展本地对象（Extending-Native-Objects）"><a href="#扩展本地对象（Extending-Native-Objects）" class="headerlink" title="扩展本地对象（Extending Native Objects）"></a>扩展本地对象（Extending Native Objects）</h2><p>不要修改本地对象。</p>
<p>比如，不要给 <code>Array.prototype</code> 引入 <code>Array#forEach</code> 。</p>
<p><a name="exceptions"></a></p>
<h2 id="异常（Exceptions）"><a href="#异常（Exceptions）" class="headerlink" title="异常（Exceptions）"></a>异常（Exceptions）</h2><p>不要抑制异常抛出。</p>
<p><a name="annotations"></a></p>
<h2 id="注解（Annotations）"><a href="#注解（Annotations）" class="headerlink" title="注解（Annotations）"></a>注解（Annotations）</h2><p>必要的时候应该写注解，来指明接下来的代码块具体将干什么。</p>
<p>注解应紧贴在被描述代码的上一行。</p>
<p>注解关键字后面应该跟一个冒号加一个空格，加一个描述性的注释。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># <span class="doctag">FIXME:</span> The client's current state should *not* affect payload processing.</span></span><br><span class="line">resetClientState()</span><br><span class="line">processPayload()</span><br></pre></td></tr></table></figure>
<p>如果注解不止一行，则下一行缩进两个空格。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># <span class="doctag">TODO:</span> Ensure that the value returned by this call falls within a certain</span></span><br><span class="line"><span class="comment">#   range, or throw an exception.</span></span><br><span class="line">analyze()</span><br></pre></td></tr></table></figure>
<p>注解有以下几类：</p>
<ul>
<li><code>TODO</code>: 描述缺失的功能，以便日后加入</li>
<li><code>FIXME</code>: 描述需要修复的代码</li>
<li><code>OPTIMIZE</code>: 描述性能低下，或难以优化的代码</li>
<li><code>HACK</code>: 描述一段值得质疑（或很巧妙）的代码</li>
<li><code>REVIEW</code>: 描述需要确认其编码意图是否正确的代码</li>
</ul>
<p>如果你必须自定义一个新的注解类型，则应该把这个注解类型记录在项目的 README 里面。</p>
<p><a name="miscellaneous"></a></p>
<h2 id="其他（Miscellaneous）"><a href="#其他（Miscellaneous）" class="headerlink" title="其他（Miscellaneous）"></a>其他（Miscellaneous）</h2><p><code>and</code> 更优于 <code>&amp;&amp;</code>.</p>
<p><code>or</code> 更优于 <code>||</code>.</p>
<p><code>is</code> 更优于 <code>==</code>.</p>
<p><code>not</code> 更优于 <code>!</code>.</p>
<p><code>or=</code> 应在可能的情况下使用：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp <span class="keyword">or</span>= &#123;&#125; <span class="comment"># 好</span></span><br><span class="line">temp = temp || &#123;&#125; <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
<p>最好用 (<code>::</code>) 访问对象的原型：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Array::slice <span class="comment"># 好</span></span><br><span class="line">Array.prototype.slice <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
<p>最好用 <code>@property</code> 而不是 <code>this.property</code>.</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> @property <span class="comment"># 好</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.property <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
<p>但是，避免使用 <strong>单独的</strong> <code>@</code>:</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">this</span> <span class="comment"># 好</span></span><br><span class="line"><span class="keyword">return</span> @ <span class="comment"># 差</span></span><br></pre></td></tr></table></figure>
<p>没有返回值的时候避免使用 <code>return</code> ，其他情况则需要显示 return 。</p>
<p>当函数需要接收可变数量的参数时，使用 splats  (<code>...</code>)。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log args... <span class="comment"># 好</span></span><br><span class="line"></span><br><span class="line">(a, b, c, rest...) -&gt; <span class="comment"># 好</span></span><br></pre></td></tr></table></figure>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2017/09/13/ubuntu-16-04-kai-ji-zi-qi-dong-jiao-ben/">ubuntu 16.04 redis开机自启动脚本</a><a class="next" href="/2017/06/29/sshdai-li-pei-zhi/">ssh代理配置</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'a3cb922b42c58d027028',
  clientSecret: 'c2f29aa3937d056e771535723d1d6b099e109d9c',
  repo: 'bin5i.github.io',
  owner: 'bin5i',
  admin: ['bin5i'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://bin.5i.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术分享/">技术分享</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活随笔/">生活随笔</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/freebsd/" style="font-size: 15px;">freebsd</a> <a href="/tags/node-js/" style="font-size: 15px;">node.js</a> <a href="/tags/mongodb/" style="font-size: 15px;">mongodb</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/bash/" style="font-size: 15px;">bash</a> <a href="/tags/pkg/" style="font-size: 15px;">pkg</a> <a href="/tags/pm2/" style="font-size: 15px;">pm2</a> <a href="/tags/postgre/" style="font-size: 15px;">postgre</a> <a href="/tags/ubuntu/" style="font-size: 15px;">ubuntu</a> <a href="/tags/aws-server/" style="font-size: 15px;">aws server</a> <a href="/tags/centos-RHEL/" style="font-size: 15px;">centos RHEL</a> <a href="/tags/JavaScript-面试题/" style="font-size: 15px;">JavaScript 面试题</a> <a href="/tags/ES6-JavaScript/" style="font-size: 15px;">ES6 JavaScript</a> <a href="/tags/linux-command/" style="font-size: 15px;">linux command</a> <a href="/tags/linux-zip-tar-gz-bz2/" style="font-size: 15px;">linux zip tar gz bz2</a> <a href="/tags/news/" style="font-size: 15px;">news</a> <a href="/tags/node-js-eventloop-macrotask-microtask/" style="font-size: 15px;">node.js eventloop macrotask microtask</a> <a href="/tags/uber-api/" style="font-size: 15px;">uber api</a> <a href="/tags/redis-cluster/" style="font-size: 15px;">redis cluster</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/udp/" style="font-size: 15px;">udp</a> <a href="/tags/mac-terminal/" style="font-size: 15px;">mac terminal</a> <a href="/tags/mac-iTerm2-hostname/" style="font-size: 15px;">mac iTerm2 hostname</a> <a href="/tags/ssh-proxy/" style="font-size: 15px;">ssh proxy</a> <a href="/tags/api-server-framework/" style="font-size: 15px;">api server framework</a> <a href="/tags/redis-upstart/" style="font-size: 15px;">redis upstart</a> <a href="/tags/html5-file/" style="font-size: 15px;">html5 file</a> <a href="/tags/ubuntu-ufw/" style="font-size: 15px;">ubuntu ufw</a> <a href="/tags/ubuntu-gitlab/" style="font-size: 15px;">ubuntu gitlab</a> <a href="/tags/node-js-modules/" style="font-size: 15px;">node.js modules</a> <a href="/tags/苹果-小时候/" style="font-size: 15px;">苹果 小时候</a> <a href="/tags/ubuntu-vpn/" style="font-size: 15px;">ubuntu vpn</a> <a href="/tags/raspberry3B-ubuntu18-server-wifi/" style="font-size: 15px;">raspberry3B ubuntu18 server wifi</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/04/13/树莓派3B在ubuntu18-04-server上配置无线wifi/">树莓派3B在ubuntu18.04 server上配置无线wifi</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/24/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/25/learn-es6/">ES6新技能</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/25/js-basic-questions/">JavaScript 基础面试题</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/25/js-interview-questions/">JavaScript 常用面试题集</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/25/nodejs-eventloop-macrotask-microtask/">macrotask and microtask in event loop of node.js</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/18/FreeBSD11-Config/">Configuration on FreeBSD11.2</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/04/Install-PostgreSql-on-Ubuntu16.04/">Install PostgreSql on Ubuntu16.04</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/09/install-postgresql-on-ubuntu16-04/">Install PostgreSql on Ubuntu16.04</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/13/ubuntu-16-04-kai-ji-zi-qi-dong-jiao-ben/">ubuntu 16.04 redis开机自启动脚本</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.ruanyifeng.com/" title="阮一峰的个人网站" target="_blank">阮一峰的个人网站</a><ul></ul><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript" title="About JavaScript" target="_blank">About JavaScript</a><ul></ul><a href="https://nodejs.org/" title="Node.js" target="_blank">Node.js</a><ul></ul><a href="https://docs.mongodb.com/" title="MongoDB Docs" target="_blank">MongoDB Docs</a><ul></ul><a href="https://www.postgresql.org/" title="PostgreSQL" target="_blank">PostgreSQL</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Bin 博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>